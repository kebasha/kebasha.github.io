<html>    <head>    <title>无限制线程的缺陷</title>    <meta content='width=device-width, initial-scale=1.0, user-scalable=no' name='viewport'><meta content='text/html; charset=utf-8' http-equiv='content-type' /><link href='/styles/github.css' rel='stylesheet' type='text/css' /><script src='/javascripts/highlight.pack.js' type='text/javascript'></script><link href='/images/kbasha.png' rel='shortcut icon'><link href='/stylesheets/style.css' rel='stylesheet' type='text/css' /><link href='/stylesheets/syntax.css' rel='stylesheet' type='text/css' /><link href='/stylesheets/responsive.css' rel='stylesheet' type='text/css' /><link href="/stylesheets/nprogress.css" rel='stylesheet' type='text/css' /><link href="/stylesheets/duoshuo.css" rel='stylesheet' type='text/css' /><link href="/feed.xml" rel="alternate" type="application/rss+xml"><script src='/javascripts/jquery.js' type='text/javascript'></script><script src='/javascripts/jquery.particleground.min.js' type='text/javascript'></script><script src='/javascripts/nprogress.js' type='text/javascript'></script><script src='/javascripts/theater.js' type='text/javascript'></script><script src='/javascripts/app.js' type='text/javascript'></script><script>    hljs.initHighlightingOnLoad();    var duoshuoQuery = {short_name:"kbasha"};</script>    </head>    <body>        <header><div id="blog-desc">    If you want do, then do.</div></header><div id="main">    <div id="left">    <a id="head-pic" class="go-back-home" href="/"><img src="../images/kbasha.jpg" alt="Home" width="100" height="100"></a>    <p>克巴沙</p>        <ul id="titles" class="titles">                    </ul>    </div>    <div id="right">    <a id="scaner-pic" class="go-back-home" href="/"><img src="../images/kbasha_id.jpg" alt="Home" width="172" height="172"></a>    <p>关注公众号</p>            </div>        <div id='container'>                        <div class="block nav">    <ul>            <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_top" href="/about.html">About</a>        </li>            <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_top" href="/">Blog</a>        </li>        <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_blank" href="https://github.com/kebasha">GitHub</a>        </li>            </ul></div>            <section class="paging">      <div class="left">      <a href="index28.html">        ‹      </a>    </div>      <div class="right">      <a href="index30.html">        ›      </a>    </div>  </section><div class="content">    <section class='post'>        <h1>            无限制线程的缺陷            <div class='date'>2016-03-31 23:39:33</div>        </h1>      <blockquote><p style="text-indent:2em;">多线程的软件设计方法确实可以最大限度地发挥现代多核处理器的计算能力，提高生产系统的吞吐量和性能。但是，若不加控制和管理工作地随意使用线程，对系统的性能反而会产生不利的影响。一种最为简单的线程创建和回收的方法类似如下代码：</p></blockquote><pre><code class="java">new Thread(new Runnable() {   public void run() {      //do sth.   }}).start();</code></pre><blockquote><p style="text-indent:2em;">以上代码创建了一个线程，并在run()方法结束后，自动回收该线程。在简单的应用系统中，这段代码并没有太多问题，但是在真实的生产环境中，系统由于真实环境的需要，可能会开户很多线程来支撑其应用。而当线程数量过大时，反而会耗尽CPU和内存资源。</p><p style="text-indent:2em;">首先，虽然与进程相比，线程是一种级的工具，但其创建和关闭依然需要时间，如果为每一个小的任务都创建一个线程，很有可能出现创建和销毁线程所占用的时间大于该线程真实工作所消耗的时间，反而会得不偿失。</p><p style="text-indent:2em;">其次，线程本身也是要占用内存空间的，大量的线徎会抢与宝贵的内存资源，如果处理不当，可能会导致Out of Memory异常。即便没有，大量的线程回收也会给GC带来很大的压力。延长GC的停顿时间。</p><p style="text-indent:2em;">因此，对线程的使用必须掌握一个度，在有限的范围内，增加线程的数量可以明显提高系统的吞吐里，但一旦超出了这个范围，大量的线程只会拖垮应用系统。因此，在生产环境中使用线程，必须对其加以控制和管理工作。</p><p style="text-indent:2em;">注意：在实际生产环境中，线程的数量必须得到控制，盲目地大量创建线程对系统性能是有伤害的。</p></blockquote>                </section>            </div>                    </div></div>        <script>            jQuery(document).ready(function($) {                App.mapKeySupport();                App.initNProgress();                App.initDuoshuo();                App.initTheater();            });        </script>    </body>    <div id="particles">    <canvas class="pg-canvas"></canvas></div><script type="text/javascript">    var _hmt = _hmt || [];    (function() {      var hm = document.createElement("script");      hm.src = "//hm.baidu.com/hm.js?93757bc26a1b57b9c6a7771db256d254";      var s = document.getElementsByTagName("script")[0];       s.parentNode.insertBefore(hm, s);    })();    $(function(){        var $body = $("body");        $("#particles").css({                "width":$body.width(),                 "height":$body.height()            }).particleground({                lineColor: '#e0e0e0',                dotColor: '#EFEFEF',                lineColor: '#EFEFEF',                   minSpeedX :0.5,                maxSpeedX :1,                minSpeedY : 0.5,                maxSpeedY :1            });    });</script><footer>  <span class="muted">© kbasha. All Rights Reserved.</span>  <br>  <br>  <!--img src="/images/scribble2.png" alt="scribble" /--></footer></html>