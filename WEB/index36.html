<html>    <head>    <title>Cookie和Session</title>    <meta content='width=device-width, initial-scale=1.0, user-scalable=no' name='viewport'><meta content='text/html; charset=utf-8' http-equiv='content-type' /><link href='/styles/github.css' rel='stylesheet' type='text/css' /><script src='/javascripts/highlight.pack.js' type='text/javascript'></script><link href='/images/kbasha.png' rel='shortcut icon'><link href='/stylesheets/style.css' rel='stylesheet' type='text/css' /><link href='/stylesheets/syntax.css' rel='stylesheet' type='text/css' /><link href='/stylesheets/responsive.css' rel='stylesheet' type='text/css' /><link href="/stylesheets/nprogress.css" rel='stylesheet' type='text/css' /><link href="/stylesheets/duoshuo.css" rel='stylesheet' type='text/css' /><link href="/feed.xml" rel="alternate" type="application/rss+xml"><script src='/javascripts/jquery.js' type='text/javascript'></script><script src='/javascripts/jquery.particleground.min.js' type='text/javascript'></script><script src='/javascripts/nprogress.js' type='text/javascript'></script><script src='/javascripts/theater.js' type='text/javascript'></script><script src='/javascripts/app.js' type='text/javascript'></script><script>    hljs.initHighlightingOnLoad();    var duoshuoQuery = {short_name:"kbasha"};</script>    </head>    <body>        <header><div id="blog-desc">    If you want do, then do.</div></header><div id="main">    <div id="left">    <a id="head-pic" class="go-back-home" href="/"><img src="../images/kbasha.jpg" alt="Home" width="100" height="100"></a>    <p>克巴沙</p>        <ul id="titles" class="titles">                    </ul>    </div>    <div id="right">    <a id="scaner-pic" class="go-back-home" href="/"><img src="../images/kbasha_id.jpg" alt="Home" width="172" height="172"></a>    <p>关注公众号</p>            </div>        <div id='container'>                        <div class="block nav">    <ul>            <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_top" href="/about.html">About</a>        </li>            <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_top" href="/">Blog</a>        </li>        <li>            <span class="line line-top"></span>            <span class="line line-right"></span>            <span class="line line-bottom"></span>            <span class="line line-left"></span>            <a target="_blank" href="https://github.com/kebasha">GitHub</a>        </li>            </ul></div>            <section class="paging">      <div class="left">      <a href="index35.html">        ‹      </a>    </div>      <div class="right">      <a href="index37.html">        ›      </a>    </div>  </section><div class="content">    <section class='post'>        <h1>            Cookie和Session            <div class='date'>2016-04-19 23:05:33</div>        </h1><p style="text-indent:2em;">Cookie和Session都为了保存状态信息，都是保存客户端状态的机制，它们都是为了解决HTTP无状态的总是而所做的努力。Session可以用Cookie来实现，也可以用URL回写的机制来实现。用Cookie来实现的Session可以认为是对Cookie更高级的应用。</p><p><strong><code>比较</code></strong></p><ul><li>1、Cookie将状态保存在客户端，Session将状态保存在服务器端</li><li>2、Cookies是服务器在本地机器上存储的小段文本并随每一个请求发送至同一个服务器。Cookie最早在RFC2109中实现，后续做了增强。网络服务器用HTTP头向客户端发送Cookies，在客户终端，浏览器解析这些Cookies并将它们保存为一个本地文件，它会自动将同一服务器的任何请求带上这些Cookies。Session并没有在HTTP的协议中定义</li><li>3、Session是针对每一个用户的，变量的值保存在服务器上，用一个SessionID来区分是哪个用户Session变量，这个值是通过用户的浏览器在访问的时候返回给服务器，当客户禁用Cookie时，这个值也可能设置为由Get来返回给服务器</li><li>4、就安全性来说：当你访问一个使用Session的站点，同时在自己机子上建立一个Cookie，建议在服务器端的Session机制更安全。因为它不会做任意读取客户存储的信息</li></ul><hr><p><strong><code>Session机制</code></strong></p><blockquote><p style="text-indent:2em;">Session机制是一种服务器端的机制，服务器使用一种类似于散列表的结构来保存信息。</p><p style="text-indent:2em;">当程序需要为某个客户端的请求创建一个Session的时候，服务器首先检查这个客户端的请求里是否已包含了一个Session标识，称为SessionID，如果已包含一个SessionID则说明以前已经为此客户端创建过Session，服务器就按照SessionID把这个Session检索出来使用（如果检索不到，可能会新建一个），如果客户端请求不包含SessionID，则为此客户端创建一个Session并且生成一个与此Session相关联的SessionID，SessionID的值应该是一个既不会重复，又不容易被找到规律以仿造的字符串，这个SessionID将被在本次响应中返回给客户端保存。</p></blockquote><hr><p><strong><code>Session的实现方式</code></strong></p><p>1、使用Cookie来实现</p><blockquote><p style="text-indent:2em;">服务器给每个Session分配一个唯一的JSESSIONID，并通过Cookie发送给客户端。当客户端发起新的请求的时候，将在Cookie头中携带这个JSESSIONID。这样服务器能够找到这个客户端对应的Session。</p></blockquote><p>2、使用URL回显来实现</p><blockquote><p style="text-indent:2em;">URL回写是指服务器在发送给浏览器页面的所有链接中都携带JSESSIONID的参数，这样客户端点击任何一个链接都会把JSESSIONID带回服务器。如果直接在浏览器输入服务端资源的URL来请求该资源，那么Session是匹配不到的。Tomcat对Session的实现，是一开始同时使用Cookie和URL回写机制，如果发现客户端支持Cookie，就继续使用Cookie，停止使用URL回写。如果发现Cookie被禁用，就一直使用URL回写。JSP开发处理到Session的时候，对页面中的链接刻使用response.encodeURL()。</p></blockquote><hr><p><strong><code>缓存的实现原理</code></strong></p><p>1、什么是Web缓存</p><blockquote><p style="text-indent:2em;">Web缓存位于Web服务器和客户端之间。缓存会根据请求保存输出内容的副本，例如Html页面，图片，文件，当下一个请求来到的时候：如果是相同的URL，缓存直接使用副本响应访问请求，而不是向源服务器再次发送请求。HTTP协议定义了相关的消息头来使Web缓存尽可能好的工作。</p></blockquote><p>2、缓存的优点</p><blockquote><p style="text-indent:2em;">减少相应延迟：因为请求从缓存服务器而不是源服务器被响应，这个过程耗时更少，让Web服务器看上去响应更快；减少网络带宽消耗：当副本被重用时会减低客户端的带宽消耗；客户可以节省带宽费用，控制带宽的需求的增长并更易于管理。</p></blockquote><hr><p><strong><code>Web缓存机制</code></strong></p><blockquote><p style="text-indent:2em;">HTTP/1.1中缓存的目的是为了在很多情况下减少发送请求，同时在许多情况下可以不需要发送完整响应。前者减少了网络回路的数量；HTTP利用一个“过期”机制来为此目的。后者减少了网络应用的带宽；HTTP用“验证”机制来为此目的。HTTP定义了3种缓存机制：</p><p style="text-indent:2em;">Freshness：允许一个回应消息可以在源服务器不被重新检查，并且可以由服务器和客户端来控制。例如，Expires回应头给了一个文档不可用的时间。Cache-Control中的Max-age标识指明了缓存的最长时间</p><p style="text-indent:2em;">Validation：用来检查以一个缓存的回应是否仍然可用。例如，如果一个回应有一个Last-Modified回应头，缓存能够使用If-Modified-Since来判断是否已经改变，以便判断根据情况发送请求</p><p style="text-indent:2em;">Invalidation：在另一个请求通过缓存的时候，常常有一个副作用。例如，如果一个URL关联到一个缓存回应，但是其后跟着POST、PUT和DELETE的请求的话，缓存就会过期</p></blockquote>                </section>            </div>                    </div></div>        <script>            jQuery(document).ready(function($) {                App.mapKeySupport();                App.initNProgress();                App.initDuoshuo();                App.initTheater();            });        </script>    </body>    <div id="particles">    <canvas class="pg-canvas"></canvas></div><script type="text/javascript">    var _hmt = _hmt || [];    (function() {      var hm = document.createElement("script");      hm.src = "//hm.baidu.com/hm.js?93757bc26a1b57b9c6a7771db256d254";      var s = document.getElementsByTagName("script")[0];       s.parentNode.insertBefore(hm, s);    })();    $(function(){        var $body = $("body");        $("#particles").css({                "width":$body.width(),                 "height":$body.height()            }).particleground({                lineColor: '#e0e0e0',                dotColor: '#EFEFEF',                lineColor: '#EFEFEF',                   minSpeedX :0.5,                maxSpeedX :1,                minSpeedY : 0.5,                maxSpeedY :1            });    });</script><footer>  <span class="muted">© kbasha. All Rights Reserved.</span>  <br>  <br>  <!--img src="/images/scribble2.png" alt="scribble" /--></footer></html>